/**
 * jquery-ecuador-ci-validator
 * @author Mario Andrés Correa <a@macool.me>
 * @license beer-ware license
 * @version 0.0.1 (2014-04-12)
 */
(function(){var t=function(t,i){return function(){return t.apply(i,arguments)}};(function(i){var n,e;return n=function(){function t(t){this.numero=t,this.numero=""+this.numero,this.valid=!1,this.codigo_provincia=null,this.tipo_de_cedula=null,this.already_validated=!1}return t.prototype.validate=function(){var t,i,n,e,s,r,o,a,d,h,l,u,c,p,v,f,m,_,C,g;if(10!==(C=this.numero.length)&&13!==C)throw this.valid=!1,Error("Longitud incorrecta.");if(a=22,this.codigo_provincia=parseInt(this.numero.substr(0,2),10),1>this.codigo_provincia||this.codigo_provincia>a)throw this.valid=!1,Error("Código de provincia incorrecto.");if(l=parseInt(this.numero[2],10),7===l||8===l)throw Error("Tercer dígito es inválido.");if(9===l?this.tipo_de_cedula="Sociedad privada o extranjera":6===l?this.tipo_de_cedula="Sociedad pública":6>l&&(this.tipo_de_cedula="Persona natural"),o=[],6>l)for(n=10,u=parseInt(this.numero.substr(9,1),10),s=2,g=this.numero.substr(0,9),c=0,m=g.length;m>c;c++)i=g[c],r=parseInt(i,10)*s,r>=10&&(r-=9),o.push(r),s=2===s?1:2;if(6===l){for(u=parseInt(this.numero.substr(8,1),10),n=11,e=[3,2,7,6,5,4,3,2],i=p=0;7>=p;i=++p)o[i]=parseInt(this.numero[i],10)*e[i];o[8]=0}if(9===l)for(u=parseInt(this.numero.substr(9,1),10),n=11,e=[4,3,2,7,6,5,4,3,2],i=v=0;8>=v;i=++v)o[i]=parseInt(this.numero[i],10)*e[i];for(h=0,f=0,_=o.length;_>f;f++)i=o[f],h+=i;if(d=h%n,t=0===d?0:n-d,6===l){if("0001"!==this.numero.substr(9,4))throw Error("RUC de empresa del sector público debe terminar en 0001");this.valid=t===u}if(9===l){if("001"!==this.numero.substr(10,3))throw Error("RUC de entidad privada debe terminar en 001");this.valid=t===u}if(6>l){if(this.numero.length>10&&"001"!==this.numero.substr(10,3))throw Error("RUC de persona natural debe terminar en 001");this.valid=t===u}return this},t.prototype.isValid=function(){return this.already_validated||this.validate(),this.valid},t}(),window.RucValidatorEc=n,e=function(){function e(n,e){this.$node=n,this.options=e,this.validateContent=t(this.validateContent,this),this.options=i.extend({},i.fn.validarCedulaEC.defaults,this.options),this.$node.on(this.options.events,this.validateContent)}return e.prototype.validateContent=function(){var t,i,e,s;if(e=""+this.$node.val(),t=this.options.strict,t||10!==(s=e.length)&&13!==s||(t=!0),t)try{new n(e).isValid()?(this.$node.removeClass(this.options.the_classes),this.options.onValid.call(this.$node)):(this.$node.addClass(this.options.the_classes),this.options.onInvalid.call(this.$node))}catch(r){i=r,this.$node.addClass(this.options.the_classes),this.options.onInvalid.call(this.$node)}return null},e}(),i.fn.validarCedulaEC=function(t){return this.each(function(){return new e(i(this),t)}),this},i.fn.validarCedulaEC.defaults={strict:!0,events:"change",the_classes:"invalid",onValid:function(){return null},onInvalid:function(){return null}}})(jQuery)}).call(this);
